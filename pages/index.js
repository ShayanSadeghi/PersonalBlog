import Head from "next/head";
import Link from "next/link";
import { useRouter } from "next/router";
import styles from "../styles/Landing.module.css";

export default function Home(props) {
  const router = useRouter();

  return (
    <div className={styles.landing}>
      <Head>
        <title>Next Blog</title>
        <meta name="description" content="Generated by create next app" />
      </Head>
      <h1>Welcome</h1>

      <div className={styles.container}>
        <div className={styles.item}>
          <Link href="/about" passHref>
            <a>
              <h3>Who am I?</h3>
            </a>
          </Link>
          <p>
            My name is <strong>Shayan Sadeghi</strong>.
            <br />
            <br />
            I&apos;m a <strong>Data Scientist</strong> and a{" "}
            <strong>web developer</strong>.
            <br />
            <br />
            To read a brief about me or send me a message use the button bellow.
          </p>

          <button onClick={() => router.push("/about")}>Contact ME</button>
        </div>

        <div className={styles.item}>
          <Link href="/posts" passHref>
            <a>
              <h3>Last Posts</h3>
            </a>
          </Link>
          {props.last_posts.map((post) => (
            <Link key={post.id} href={`/posts/${post.id}`} passHref>
              <div className={styles.card}>
                <h4>{post.title.rendered}</h4>
                <small>{post.date.slice(0, 10)}</small>
              </div>
            </Link>
          ))}
        </div>

        <div className={styles.item}>
          <Link href="https://github.com/ShayanSadeghi" passHref>
            <a target="_blank">
              <h3>Github</h3>
            </a>
          </Link>
          {props.pins.map((pin) => (
            <div key={pin.id} className={styles.card}>
              <strong>{pin.title}</strong>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
}

export async function getStaticProps() {
  const gh = [
    { id: "1", title: "Tick8" },
    { id: "2", title: "NoteApp" },
    { id: "3", title: "xepersian_quickstart" },
  ];

  const last_posts = await (
    await fetch(
      "http://localhost:8000/wp-json/wp/v2/posts?_fields=id,title,date"
    )
  ).json();

  return {
    props: {
      pins: gh,
      last_posts,
    },
  };
}
